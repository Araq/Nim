---
kind: pipeline
type: docker
name: nim-on-arm64

platform:
  os: linux
  arch: arm64

clone:
  depth: 1

steps:
- name: runci
  image: ghcr.io/alaviss/nim-ci:sha-cbaa8fd@sha256:5416ad30a5d65ac19fa4cc2684e6f62fd7222d092f841548b9df297bc7c0cac8
  commands:
  - git clone --depth 1 https://github.com/nim-lang/csources.git
  - export PATH=$PWD/bin:$PATH
  - make -C csources -j$(nproc)
  - nim c koch
  - "if ! ./koch runCI; then\n  nim c -r tools/ci_testresults\n  exit 1\nfi\n"

---
kind: pipeline
type: docker
name: nim-on-arm

platform:
  os: linux
  arch: arm

clone:
  depth: 1

steps:
- name: runci
  image: ghcr.io/alaviss/nim-ci:sha-cbaa8fd@sha256:8d99e0d3cf03e61200cd08a63ed13b4cfb8d342b95fdb49ec99c3be71faa180f
  commands:
  - git clone --depth 1 https://github.com/nim-lang/csources.git
  - export PATH=$PWD/bin:$PATH
  - make -C csources -j$(nproc) ucpu=arm
  - nim c koch
  - "if ! ./koch runCI; then\n  nim c -r tools/ci_testresults\n  exit 1\nfi\n"

...
