---
kind: pipeline
type: docker
name: nim-on-arm64

platform:
  os: linux
  arch: arm64

clone:
  depth: 1

steps:
- name: runci
  image: ghcr.io/alaviss/nim-ci:sha-f673d96@sha256:a9c72fa9a13dc5d2b2db7080632792f5c04cd0e0b19c1d995356e634449777ea
  commands:
  - git clone --depth 1 https://github.com/nim-lang/csources.git
  - export PATH=$PWD/bin:$PATH
  - make -C csources -j$(nproc)
  - nim c koch
  - "if ! ./koch runCI; then\n  nim c -r tools/ci_testresults\n  exit 1\nfi\n"

---
kind: pipeline
type: docker
name: nim-on-arm

platform:
  os: linux
  arch: arm

clone:
  depth: 1

steps:
- name: runci
  image: ghcr.io/alaviss/nim-ci:sha-f673d96@sha256:b6c99973ca31d35f95508193d49306c5fa933e3f6090b8ffb56fee16b32705fc
  commands:
  - git clone --depth 1 https://github.com/nim-lang/csources.git
  - export PATH=$PWD/bin:$PATH
  - make -C csources -j$(nproc) ucpu=arm
  - nim c koch
  - "if ! ./koch runCI; then\n  nim c -r tools/ci_testresults\n  exit 1\nfi\n"

...
